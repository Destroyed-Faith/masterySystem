<div class="stone-powers-dialog">
  <div class="dialog-header">
    <h2>{{actor.name}}: Stone Powers</h2>
    <p>Activate stone powers using your attribute stone pools.</p>
  </div>

  <div class="stone-pools-display">
    <h3>Available Stones</h3>
    <div class="pools-grid">
      {{#each pools as |pool|}}
      <div class="pool-item">
        <span class="pool-name">{{pool.name}}</span>
        <span class="pool-value">{{pool.available}}/{{pool.max}}</span>
        {{#if pool.sustained}}
        <span class="pool-sustained">({{pool.sustained}} sustained)</span>
        {{/if}}
      </div>
      {{/each}}
    </div>
  </div>

  <div class="powers-list">
    {{#each powersByAttribute as |powers attr|}}
    <div class="power-group">
      <h4>{{#if (eq attr 'generic')}}Generic Powers{{else}}{{attr}} Powers{{/if}}</h4>
      <div class="powers-grid">
        {{#each powers as |power|}}
        <div class="power-item">
          <div class="power-info">
            <strong>{{power.name}}</strong>
            <p class="power-desc">{{power.description}}</p>
            <span class="power-cost">Cost: {{power.cost}} stone(s)</span>
          </div>
          <button type="button" 
                  class="power-activate-btn js-activate-power" 
                  data-power-id="{{power.id}}"
                  data-attribute-key="{{#if (eq power.attribute 'generic')}}{{../attr}}{{else}}{{power.attribute}}{{/if}}"
                  {{#unless ../hasCombat}}disabled title="Only available during combat"{{/unless}}>
            <i class="fas fa-gem"></i> Activate
          </button>
        </div>
        {{/each}}
      </div>
    </div>
    {{/each}}
  </div>

  <div class="dialog-footer">
    <button type="button" class="dialog-btn js-close">
      <i class="fas fa-times"></i> Close
    </button>
  </div>
</div>
